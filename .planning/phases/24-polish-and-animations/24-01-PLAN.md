---
phase: 24-polish-and-animations
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - site/src/components/ui/NavBar.astro
  - site/src/components/sections/TerminalDemo.astro
  - site/src/components/sections/Hero.astro
  - site/src/pages/index.astro
  - site/src/styles/global.css
autonomous: true

must_haves:
  truths:
    - "A sticky navigation bar is visible at the top of the page with links to page sections"
    - "Clicking a nav link smoothly scrolls to the target section (not instant jump)"
    - "The target section heading is fully visible after scroll (not hidden behind nav bar)"
    - "An animated terminal simulates python orchestrator.py output with per-character typing for the command and line-by-line reveal for output"
    - "ThemeToggle lives inside the nav bar (not floating separately)"
  artifacts:
    - path: "site/src/components/ui/NavBar.astro"
      provides: "Sticky nav bar with logo, anchor links, and ThemeToggle"
      min_lines: 25
    - path: "site/src/components/sections/TerminalDemo.astro"
      provides: "Terminal animation component with typing effect JS"
      min_lines: 80
    - path: "site/src/styles/global.css"
      provides: "scroll-behavior: smooth and scroll-margin-top rules"
      contains: "scroll-behavior"
  key_links:
    - from: "site/src/components/ui/NavBar.astro"
      to: "section[id] elements"
      via: "anchor href=#features, #architecture, etc."
      pattern: 'href="#'
    - from: "site/src/pages/index.astro"
      to: "site/src/components/ui/NavBar.astro"
      via: "import and render before main"
      pattern: "import NavBar"
    - from: "site/src/components/sections/TerminalDemo.astro"
      to: "site/src/components/sections/Hero.astro"
      via: "TerminalDemo rendered inside Hero replacing ScreenshotFrame gradient"
      pattern: "import TerminalDemo"
---

<objective>
Create the sticky navigation bar with smooth scroll anchor links and the animated terminal demo component, integrating both into the page.

Purpose: PLSH-03 requires "anchor links to page sections from nav bar" (no nav bar currently exists) and PLSH-01 requires an animated terminal simulating pipeline output. These are the two new components for Phase 24.

Output: NavBar.astro, TerminalDemo.astro, updated Hero.astro, updated index.astro, updated global.css
</objective>

<execution_context>
@/Users/patrykattc/.claude/get-shit-done/workflows/execute-plan.md
@/Users/patrykattc/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/24-polish-and-animations/24-RESEARCH.md

@site/src/pages/index.astro
@site/src/styles/global.css
@site/src/layouts/BaseLayout.astro
@site/src/components/ui/ThemeToggle.astro
@site/src/components/sections/Hero.astro
@site/src/components/ui/ScreenshotFrame.astro
</context>

<tasks>

<task type="auto">
  <name>Task 1: NavBar component + smooth scroll CSS + integrate into page</name>
  <files>
    site/src/components/ui/NavBar.astro
    site/src/styles/global.css
    site/src/pages/index.astro
  </files>
  <action>
    **Create `site/src/components/ui/NavBar.astro`:**
    - Fixed/sticky nav bar at top: `fixed top-0 left-0 right-0 z-40`
    - Background with backdrop blur: `bg-white/80 dark:bg-surface-950/80 backdrop-blur-sm`
    - Bottom border: `border-b border-surface-200 dark:border-surface-800`
    - Inner container: `max-w-6xl mx-auto px-4 flex items-center justify-between h-14`
    - Left side: "JobFlow" text in font-display font-bold, linked to `#hero` or top of page
    - Right side: `hidden md:flex items-center gap-6` containing anchor links:
      - Features (#features)
      - How It Works (#architecture)
      - Code (#code)
      - Timeline (#timeline)
      - Quick Start (#quickstart)
    - Link styles: `text-sm text-surface-600 dark:text-surface-300 hover:text-primary-600 dark:hover:text-primary-400 transition-colors`
    - Import and render ThemeToggle as the last item in the right-side flex container (after the links)
    - NO hamburger menu for mobile -- research confirmed single-page sites don't need it, mobile users scroll naturally

    **Update `site/src/styles/global.css`** (append after @theme block):
    ```css
    html {
      scroll-behavior: smooth;
    }

    @media (prefers-reduced-motion: reduce) {
      html {
        scroll-behavior: auto;
      }
    }

    section[id] {
      scroll-margin-top: 4rem;
    }
    ```

    **Update `site/src/pages/index.astro`:**
    - Add `import NavBar from "../components/ui/NavBar.astro";`
    - Remove the `<div class="fixed top-4 right-4 z-50"><ThemeToggle /></div>` block (ThemeToggle moves into NavBar)
    - Remove the `import ThemeToggle` line (NavBar handles it now)
    - Add `<NavBar />` as the first child inside `<BaseLayout>`, before `<main>`
    - Add `pt-14` to the `<main>` tag to offset for the fixed nav bar height (h-14 = 3.5rem)
  </action>
  <verify>
    Run `cd /Users/patrykattc/work/jobs/site && npm run build` -- must succeed with no errors.
    Verify NavBar.astro imports ThemeToggle and renders anchor links.
    Verify index.astro no longer has standalone ThemeToggle div.
    Verify global.css has scroll-behavior: smooth, prefers-reduced-motion override, and scroll-margin-top rule.
  </verify>
  <done>
    A sticky nav bar is visible at page top with "JobFlow" logo and 5 anchor links (Features, How It Works, Code, Timeline, Quick Start) plus the theme toggle. Clicking links smoothly scrolls to the target section. Section headings are not hidden behind the nav bar due to scroll-margin-top.
  </done>
</task>

<task type="auto">
  <name>Task 2: TerminalDemo component + integrate into Hero</name>
  <files>
    site/src/components/sections/TerminalDemo.astro
    site/src/components/sections/Hero.astro
  </files>
  <action>
    **Create `site/src/components/sections/TerminalDemo.astro`:**

    The component renders a terminal window (dark background, monospace font) with animated output simulating `python orchestrator.py --platforms indeed remoteok`. Structure:

    HTML structure:
    - Outer container with terminal styling: `rounded-lg overflow-hidden shadow-2xl border border-surface-700`
    - Title bar mimicking a terminal (not browser): `flex items-center gap-2 px-4 py-3 bg-surface-800 border-b border-surface-700`
      - Traffic light dots (same as ScreenshotFrame)
      - Center text: "Terminal" in `text-xs text-surface-400 font-mono`
    - Content area: `bg-surface-950 p-4 font-mono text-sm text-green-400 leading-relaxed min-h-[320px]` (always dark regardless of theme -- terminals are dark)
    - Inside content area: a container `div#terminal-output` that holds all terminal lines
    - Each line is a `<div data-line="{type}" data-text="{text}" data-delay="{delay}" style="visibility: hidden;">` where visibility starts hidden and JS reveals them sequentially

    Terminal line data (from research -- verified from orchestrator.py source):
    ```
    { type: 'input', text: '$ python orchestrator.py --platforms indeed remoteok', delay: 0 }
    { type: 'output', text: '============================================================', delay: 300 }
    { type: 'output', text: '  JOB SEARCH AUTOMATION PIPELINE', delay: 50 }
    { type: 'output', text: '============================================================', delay: 50 }
    { type: 'output', text: '', delay: 200 }
    { type: 'output', text: '[Phase 0] Environment Setup', delay: 300 }
    { type: 'output', text: '------------------------------------------------------------', delay: 50 }
    { type: 'output', text: '  Python 3.14.0', delay: 200 }
    { type: 'output', text: '  Credentials:', delay: 100 }
    { type: 'output', text: '    indeed    OK', delay: 150 }
    { type: 'output', text: '    remoteok  OK', delay: 150 }
    { type: 'output', text: '  Setup complete.', delay: 200 }
    { type: 'output', text: '', delay: 100 }
    { type: 'output', text: '[Phase 1] Platform Login', delay: 300 }
    { type: 'output', text: '------------------------------------------------------------', delay: 50 }
    { type: 'output', text: '  Indeed: logged in', delay: 800 }
    { type: 'output', text: '  RemoteOK: no login required', delay: 200 }
    { type: 'output', text: '', delay: 100 }
    { type: 'output', text: '[Phase 2] Job Search', delay: 300 }
    { type: 'output', text: '------------------------------------------------------------', delay: 50 }
    { type: 'output', text: '  Indeed: 22 jobs found', delay: 1200 }
    { type: 'output', text: '  RemoteOK: 91 jobs found', delay: 600 }
    { type: 'output', text: '', delay: 100 }
    { type: 'output', text: '[Phase 3] Scoring & Deduplication', delay: 300 }
    { type: 'output', text: '------------------------------------------------------------', delay: 50 }
    { type: 'output', text: '  Total raw jobs: 113', delay: 200 }
    { type: 'output', text: '  After dedup:    106', delay: 400 }
    { type: 'output', text: '  Score 3+:       19', delay: 600 }
    { type: 'output', text: '', delay: 100 }
    { type: 'output', text: '============================================================', delay: 300 }
    { type: 'output', text: '  PIPELINE COMPLETE', delay: 50 }
    { type: 'output', text: '============================================================', delay: 50 }
    { type: 'output', text: '  Total scored jobs (3+): 19', delay: 100 }
    { type: 'output', text: '  Score 5: 3  |  Score 4: 8', delay: 100 }
    { type: 'output', text: '============================================================', delay: 50 }
    ```

    JavaScript in a `<script>` tag (Astro-processed, not is:inline):
    - `wait(ms)` helper returning a Promise with setTimeout
    - `typeTerminal(container)` async function that iterates over all `[data-line]` children:
      - For 'input' type lines: type character-by-character at 30-70ms random intervals (30 + Math.random() * 40), with a blinking cursor span at the end while typing
      - For 'output' type lines: reveal instantly (set visibility to visible)
      - For empty lines: just reveal (acts as spacing)
      - Wait `data-delay` ms before starting each line
    - `initTerminal()` function:
      - Check `prefers-reduced-motion` -- if true, reveal all lines immediately (no animation) and return
      - Find container `#terminal-output`
      - If already animated (`container.dataset.animated === 'true'`), return
      - Create IntersectionObserver with `{ threshold: 0.3 }` that fires `typeTerminal(container)` on first intersection, sets `container.dataset.animated = 'true'`, and unobserves
      - Observe the container
    - Call `initTerminal()` at script bottom
    - Add `document.addEventListener('astro:page-load', initTerminal)` for ClientRouter compatibility

    CSS: Add a `@keyframes blink` animation for the cursor (pure CSS, in a `<style>` tag in the component):
    ```css
    @keyframes blink {
      0%, 100% { opacity: 1; }
      50% { opacity: 0; }
    }
    .terminal-cursor {
      animation: blink 1s step-end infinite;
    }
    ```

    **Update `site/src/components/sections/Hero.astro`:**
    - Replace `import ScreenshotFrame from "../ui/ScreenshotFrame.astro";` with `import TerminalDemo from "./TerminalDemo.astro";`
    - Replace `<ScreenshotFrame />` with `<TerminalDemo />`
    - Keep all other Hero content (headline, description, CTAs) unchanged

    NOTE: ScreenshotFrame.astro itself is NOT deleted -- it may be useful later for actual screenshots. We just stop using it in Hero.
  </action>
  <verify>
    Run `cd /Users/patrykattc/work/jobs/site && npm run build` -- must succeed with no errors.
    Verify TerminalDemo.astro contains the terminal line data, typing JS with IntersectionObserver, and cursor blink CSS.
    Verify Hero.astro imports TerminalDemo instead of ScreenshotFrame.
    Verify the script handles prefers-reduced-motion by instantly revealing all lines.
    Verify the IntersectionObserver fires only once (unobserve + data-animated flag).
  </verify>
  <done>
    The Hero section displays a terminal window that animates when scrolled into view: the command line types character-by-character, output lines appear sequentially with realistic delays simulating pipeline execution. Animation fires once and respects prefers-reduced-motion. The terminal is always dark-themed regardless of page theme.
  </done>
</task>

</tasks>

<verification>
1. `cd /Users/patrykattc/work/jobs/site && npm run build` succeeds with zero errors
2. NavBar.astro exists with anchor links to #features, #architecture, #code, #timeline, #quickstart
3. ThemeToggle is inside NavBar, not floating separately in index.astro
4. global.css has scroll-behavior: smooth with prefers-reduced-motion fallback and scroll-margin-top on section[id]
5. TerminalDemo.astro exists with terminal line data, typing animation JS, IntersectionObserver, and cursor blink CSS
6. Hero.astro imports TerminalDemo (not ScreenshotFrame)
7. index.astro has NavBar before main, main has pt-14 offset, no standalone ThemeToggle
</verification>

<success_criteria>
- Sticky nav bar visible at top with "JobFlow" logo, 5 section links, and theme toggle
- Clicking nav links smoothly scrolls to sections with headings fully visible (not under nav)
- Terminal demo animates pipeline output with character typing and sequential line reveals
- Terminal animation fires once on viewport entry, respects reduced motion preference
- Build succeeds with zero errors
</success_criteria>

<output>
After completion, create `.planning/phases/24-polish-and-animations/24-01-SUMMARY.md`
</output>
