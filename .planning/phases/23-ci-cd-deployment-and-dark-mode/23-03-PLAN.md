---
phase: 23-ci-cd-deployment-and-dark-mode
plan: 03
type: execute
wave: 2
depends_on: ["23-01", "23-02"]
files_modified: []
autonomous: false

must_haves:
  truths:
    - "Site is accessible at the public GitHub Pages URL with all sections visible"
    - "Dark mode toggle works and theme persists across refresh"
    - "Python CI does not trigger on site-only changes"
    - "JSON-LD and sitemap are accessible at deployed URL"
  artifacts: []
  key_links: []
---

<objective>
Verify deployment works end-to-end: push triggers deploy workflow, site loads at public URL, dark mode works, CI isolation correct.

Purpose: DPLY-04 requires the site to be accessible at the public URL with all assets loading. This checkpoint ensures the deployment pipeline, dark mode, and SEO artifacts all work in production.
Output: Verified production deployment
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/23-ci-cd-deployment-and-dark-mode/23-01-SUMMARY.md
@.planning/phases/23-ci-cd-deployment-and-dark-mode/23-02-SUMMARY.md
</context>

<tasks>

<task type="checkpoint:human-action" gate="blocking">
  <name>Task 1: Enable GitHub Pages in repo settings</name>
  <files></files>
  <action>
GitHub Pages must be enabled with "GitHub Actions" as the source before the deploy workflow can succeed. This requires repo admin access in the browser.

Steps for user:
1. Go to https://github.com/PatrykQuantumNomad/jobs/settings/pages
2. Under "Build and deployment" > "Source", select "GitHub Actions"
3. Save

If Pages is already configured with GitHub Actions source, skip this step and type "already done".

Resume signal: Type "done" when Pages is enabled, or "already done" if it was already configured.
  </action>
  <verify>User confirms Pages is enabled with GitHub Actions source.</verify>
  <done>GitHub Pages is enabled in repo settings with GitHub Actions as the deployment source.</done>
</task>

<task type="auto">
  <name>Task 2: Push to main and monitor deployment</name>
  <files></files>
  <action>
Push the current main branch to trigger the deploy workflow:
```bash
git push origin main
```

Then monitor the workflow run:
```bash
gh run list --workflow=deploy-site.yml --limit=1
```

Wait for the workflow to complete (poll with `gh run watch` if available, or check status periodically). Report the deployment URL from the workflow output.

If the deploy workflow does NOT trigger (because the push didn't include site/** changes from THIS session), trigger manually:
```bash
gh workflow run deploy-site.yml
```

Also verify the Python CI workflow status -- it should NOT have been triggered by site-only changes:
```bash
gh run list --workflow=ci.yml --limit=3
```
  </action>
  <verify>`gh run list --workflow=deploy-site.yml --limit=1` shows a successful run. The deployment URL is accessible.</verify>
  <done>Deploy workflow ran successfully. Site is deployed to GitHub Pages.</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <name>Task 3: Verify deployed site, dark mode, and SEO artifacts</name>
  <files></files>
  <action>
User verifies the complete Phase 23 deployment in production.

What was built: CI/CD deployment pipeline, dark mode with toggle, JSON-LD structured data, and sitemap.

Verification steps:
1. Visit the deployed site URL (likely https://patrykgolabek.github.io/jobs/ or check gh-pages deployment output)
2. Verify all 9 sections render correctly with styles, fonts, and icons loading
3. Click the theme toggle (sun/moon icon, top-right corner) -- page should switch between light and dark modes
4. Set to dark mode, refresh the page -- dark mode should persist (no white flash)
5. View page source -- search for "SoftwareApplication" to confirm JSON-LD is present
6. Visit {site-url}/sitemap-index.xml -- should show sitemap XML
7. Check GitHub Actions tab -- confirm deploy-site.yml ran successfully and ci.yml was NOT triggered by site changes

Resume signal: Type "approved" if everything works, or describe any issues found.
  </action>
  <verify>User confirms all 7 verification steps pass.</verify>
  <done>Deployed site verified: all sections render, dark mode works with toggle and persistence, JSON-LD present, sitemap accessible, workflow isolation confirmed.</done>
</task>

</tasks>

<verification>
1. Site loads at public URL with all sections, styles, and fonts
2. Dark mode toggle switches themes and persists across refresh
3. JSON-LD structured data visible in page source
4. Sitemap accessible at deployed URL
5. Deploy workflow triggered correctly, Python CI not triggered by site changes
</verification>

<success_criteria>
- Site accessible at public GitHub Pages URL with all 9 sections rendering correctly
- Dark mode works via toggle and system preference, persists across refresh
- JSON-LD SoftwareApplication schema present in page source
- Sitemap XML accessible at deployed URL
- Workflow isolation: site changes trigger deploy only, Python changes trigger CI only
</success_criteria>

<output>
After completion, create `.planning/phases/23-ci-cd-deployment-and-dark-mode/23-03-SUMMARY.md`
</output>
