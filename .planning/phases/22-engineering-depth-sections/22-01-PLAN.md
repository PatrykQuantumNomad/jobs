---
phase: 22-engineering-depth-sections
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - site/src/icons/arrow-right.svg
  - site/src/components/sections/Architecture.astro
  - site/src/components/sections/CodeSnippets.astro
autonomous: true

must_haves:
  truths:
    - "A pipeline diagram shows 5 numbered phases (Setup, Login, Search, Score, Apply) with connecting arrows on desktop and vertical stack on mobile"
    - "3 syntax-highlighted code snippets (Platform Protocol, Decorator Registry, Scoring Engine) render with correct Python coloring on a dark background"
    - "Code blocks have horizontal scroll on overflow rather than breaking the page layout"
  artifacts:
    - path: "site/src/icons/arrow-right.svg"
      provides: "Arrow connector icon for pipeline steps"
    - path: "site/src/components/sections/Architecture.astro"
      provides: "5-phase pipeline diagram section"
      contains: "id=\"architecture\""
    - path: "site/src/components/sections/CodeSnippets.astro"
      provides: "3 syntax-highlighted code snippet cards"
      contains: "Code"
  key_links:
    - from: "site/src/components/sections/Architecture.astro"
      to: "site/src/icons/arrow-right.svg"
      via: "SVG component import"
      pattern: "import.*arrow-right"
    - from: "site/src/components/sections/CodeSnippets.astro"
      to: "astro:components"
      via: "Astro built-in Code component"
      pattern: "import.*Code.*from.*astro:components"
---

<objective>
Create the Architecture pipeline diagram section (CONT-05) and Code Snippets section (CONT-06) -- the two most technically involved new sections requiring an SVG icon connector and Astro's built-in Shiki-powered `<Code />` component.

Purpose: These sections transition the page from "what it does" (Features/TechStack) to "how it's built" -- showing engineering depth to technical visitors.
Output: Two self-contained Astro section components ready for page composition in plan 02.
</objective>

<execution_context>
@/Users/patrykattc/.claude/get-shit-done/workflows/execute-plan.md
@/Users/patrykattc/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/22-engineering-depth-sections/22-RESEARCH.md
@.planning/phases/21-core-sections-and-responsive-design/21-02-SUMMARY.md

Source files for code snippet content:
@platforms/protocols.py
@platforms/registry.py
@scorer.py

Existing section patterns to follow:
@site/src/components/sections/Features.astro
@site/src/components/sections/TechStack.astro
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create arrow-right SVG icon and Architecture pipeline section</name>
  <files>
    site/src/icons/arrow-right.svg
    site/src/components/sections/Architecture.astro
  </files>
  <action>
    1. Create `site/src/icons/arrow-right.svg` -- a simple right-pointing arrow/chevron icon, stroke-based (matching existing icon style), 24x24 viewBox, `currentColor` for stroke. Keep it minimal (3-5 lines SVG).

    2. Create `site/src/components/sections/Architecture.astro` implementing CONT-05:
       - Section with `id="architecture"` and `bg-white` background (follows TechStack's `bg-surface-50`)
       - Heading: "How It Works" with subtitle "A five-phase pipeline from configuration to application"
       - Data array with 5 phases:
         - Step 1: Setup -- "Config & credentials"
         - Step 2: Login -- "Platform auth"
         - Step 3: Search -- "Job discovery"
         - Step 4: Score -- "Match scoring"
         - Step 5: Apply -- "Application submit"
       - Desktop layout (`hidden md:flex`): Horizontal row of numbered circles (bg-primary-600 text-white, w-14 h-14 rounded-full) with name/description below, arrow-right SVG icons between steps (text-primary-300), each step is flex-1
       - Mobile layout (`md:hidden`): Vertical stack with numbered circles (w-10 h-10) and text to the right, `space-y-6`
       - Use `max-w-6xl mx-auto px-4` container with `py-20` vertical padding
       - Import ArrowRightIcon from the SVG file; render between steps only (not after last step) using `i < phases.length - 1` conditional
       - Follow the established pattern: `font-display` for headings, `text-surface-900` for titles, `text-surface-500`/`text-surface-600` for descriptions
  </action>
  <verify>
    Run `cd /Users/patrykattc/work/jobs/site && npm run build 2>&1` -- should complete with zero errors. Check that `arrow-right.svg` exists and `Architecture.astro` exists. Grep the build output HTML for "How It Works" and all 5 phase names.
  </verify>
  <done>Architecture section builds without errors; 5 pipeline phases render with numbered circles; arrow-right icon exists for connectors; responsive desktop (horizontal) and mobile (vertical) layouts defined via Tailwind breakpoint classes.</done>
</task>

<task type="auto">
  <name>Task 2: Create Code Snippets section with Shiki syntax highlighting</name>
  <files>site/src/components/sections/CodeSnippets.astro</files>
  <action>
    Create `site/src/components/sections/CodeSnippets.astro` implementing CONT-06:

    1. Import `{ Code } from 'astro:components'`
    2. Define `const THEME = "github-dark-default"` for DRY theme usage
    3. Define `snippets` data array with 3 entries, each having: title, filename, description, lang ("python"), and code (string). The code strings should be curated 12-20 line excerpts:

       **Snippet 1: Platform Protocol** (`platforms/protocols.py`)
       - Show the `@runtime_checkable` decorator and `BrowserPlatform(Protocol)` class with its method signatures
       - ~12 lines: class declaration + `platform_name: str` + method stubs (`init`, `login`, `is_logged_in`, `search`, `get_job_details`, `apply`)

       **Snippet 2: Decorator Registry** (`platforms/registry.py`)
       - Show `register_platform` function: the decorator factory, protocol validation via `_validate_against_protocol`, and `_REGISTRY` insertion
       - ~14 lines: function signature + inner decorator + validation + registry insertion + return

       **Snippet 3: Scoring Engine** (`scorer.py`)
       - Show `JobScorer` class with `_compute` method: weight-based scoring with title, tech, remote, salary factors, raw score calculation, final 1-5 bucketing, ScoreBreakdown return
       - ~18 lines: class + method + 4 factor computations + weighted sum + bucketing + return

       Reference the actual source files (listed in context) for accurate code. Trim imports, docstrings beyond the class-level one, and helper methods. Keep core logic only.

    4. Section layout:
       - `id="code"` with `bg-surface-900` dark background (creates visual break, complements github-dark-default theme)
       - Heading: "Under the Hood" in `text-white`, subtitle in `text-surface-400`
       - Each snippet in a card: `rounded-xl overflow-hidden border border-surface-700`
       - Card header: `bg-surface-800 px-6 py-4` with title (`text-white font-display font-semibold`), description (`text-sm text-surface-400`), filename (`text-xs text-surface-500 font-mono`)
       - Card body: `overflow-x-auto` wrapper around `<Code code={snippet.code} lang={snippet.lang} theme={THEME} />`
       - Stack cards with `space-y-8`
       - Container: `max-w-6xl mx-auto px-4 py-20`

    5. Do NOT use `wrap` prop on Code component -- horizontal scroll is better for code readability. The `overflow-x-auto` container handles mobile overflow.
  </action>
  <verify>
    Run `cd /Users/patrykattc/work/jobs/site && npm run build 2>&1` -- should complete with zero errors. Grep built HTML for "Under the Hood", all 3 snippet titles ("Platform Protocol", "Decorator Registry", "Scoring Engine"), and the `shiki` class (confirms Shiki processed the code blocks). Verify no page-level horizontal scroll by checking `overflow-x-auto` is present in the output.
  </verify>
  <done>CodeSnippets section builds without errors; 3 Python code snippets render with syntax highlighting via Shiki; dark background (bg-surface-900) with github-dark-default theme; each snippet has title, description, filename label, and scrollable code block.</done>
</task>

</tasks>

<verification>
1. `cd /Users/patrykattc/work/jobs/site && npm run build` completes with zero errors
2. `site/src/icons/arrow-right.svg` exists and is a valid SVG
3. `site/src/components/sections/Architecture.astro` contains `id="architecture"`, 5 phase entries, responsive breakpoint classes (`md:flex`, `md:hidden`)
4. `site/src/components/sections/CodeSnippets.astro` contains `import { Code } from 'astro:components'`, `github-dark-default` theme, 3 snippet entries
5. Built HTML contains "How It Works", "Under the Hood", all 5 phase names, all 3 snippet titles
</verification>

<success_criteria>
- Architecture section renders a 5-phase pipeline diagram with numbered circles and arrow connectors (desktop horizontal, mobile vertical)
- Code Snippets section renders 3 syntax-highlighted Python code blocks on a dark background
- Both sections follow established patterns (data arrays, font-display headings, surface color palette, responsive Tailwind classes)
- Site builds without errors with both new components
</success_criteria>

<output>
After completion, create `.planning/phases/22-engineering-depth-sections/22-01-SUMMARY.md`
</output>
