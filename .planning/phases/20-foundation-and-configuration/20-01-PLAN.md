---
phase: 20-foundation-and-configuration
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - site/astro.config.mjs
  - site/package.json
  - site/tsconfig.json
  - site/src/styles/global.css
  - site/src/layouts/BaseLayout.astro
  - site/src/pages/index.astro
  - site/public/og-image.png
  - .gitignore
autonomous: true

must_haves:
  truths:
    - "`npm run dev` inside `/site` serves a page at localhost:4321/jobs/ with correct base path"
    - "`npm run build && npm run preview` produces output with no broken paths or missing assets"
    - "Page renders with Inter body text and DM Sans display headings (professional blues/grays palette)"
    - "Page source contains complete OpenGraph meta tags (og:title, og:description, og:url, og:image) with absolute URLs"
    - "Page source contains Twitter Card meta tags (twitter:card=summary_large_image, twitter:title, twitter:description, twitter:image)"
    - "Root `.gitignore` includes `node_modules/`, `site/dist/`, and `site/.astro/` entries"
  artifacts:
    - path: "site/astro.config.mjs"
      provides: "Astro config with base:/jobs, site URL, trailingSlash:always, Tailwind vite plugin"
      contains: "base.*jobs"
    - path: "site/src/styles/global.css"
      provides: "Tailwind v4 import + @theme design tokens (primary blues, surface grays, font families)"
      contains: "@theme"
    - path: "site/src/layouts/BaseLayout.astro"
      provides: "HTML shell with OG/Twitter meta tags, font imports, global CSS, ClientRouter"
      contains: "og:title"
    - path: "site/src/pages/index.astro"
      provides: "Landing page using BaseLayout with placeholder content"
      contains: "BaseLayout"
    - path: ".gitignore"
      provides: "Updated gitignore with site build artifacts"
      contains: "site/dist"
  key_links:
    - from: "site/src/layouts/BaseLayout.astro"
      to: "site/src/styles/global.css"
      via: "import ../styles/global.css"
      pattern: 'import.*global\.css'
    - from: "site/src/layouts/BaseLayout.astro"
      to: "@fontsource-variable packages"
      via: "import in frontmatter"
      pattern: 'import.*@fontsource-variable'
    - from: "site/src/pages/index.astro"
      to: "site/src/layouts/BaseLayout.astro"
      via: "import and wrapping content"
      pattern: 'import BaseLayout'
    - from: "site/astro.config.mjs"
      to: "@tailwindcss/vite"
      via: "vite.plugins array"
      pattern: 'tailwindcss\(\)'
---

<objective>
Scaffold the Astro project in `/site` with Tailwind CSS v4, self-hosted fonts, professional design tokens, BaseLayout with SEO meta tags, and a minimal index page -- the foundation every subsequent phase builds on.

Purpose: Establish the project structure, design system, and build pipeline so that all future phases can focus on content and features without touching configuration.
Output: A working Astro site at `localhost:4321/jobs/` with correct base path, professional palette, Inter/DM Sans fonts, and complete OG/Twitter meta tags.
</objective>

<execution_context>
@/Users/patrykattc/.claude/get-shit-done/workflows/execute-plan.md
@/Users/patrykattc/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/20-foundation-and-configuration/20-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Scaffold Astro project with Tailwind v4 and design tokens</name>
  <files>
    site/astro.config.mjs
    site/package.json
    site/tsconfig.json
    site/src/styles/global.css
    .gitignore
  </files>
  <action>
    1. Scaffold the Astro project:
       ```bash
       cd /Users/patrykattc/work/jobs
       npm create astro@latest site -- --template minimal --no-install
       ```
       If the CLI prompts for options, accept defaults (no TypeScript strict, no git init).

    2. Install dependencies:
       ```bash
       cd /Users/patrykattc/work/jobs/site
       npm install tailwindcss @tailwindcss/vite @fontsource-variable/inter @fontsource-variable/dm-sans
       ```

    3. Configure `site/astro.config.mjs` exactly as follows (replace whatever the scaffolder created):
       - `site: "https://patrykgolabek.github.io"`
       - `base: "/jobs"`
       - `trailingSlash: "always"`
       - `vite.plugins: [tailwindcss()]` where `tailwindcss` is imported from `@tailwindcss/vite`

    4. Create `site/src/styles/global.css` with:
       - `@import "tailwindcss";` as the FIRST line (required by Tailwind v4)
       - A `@theme` block defining:
         - `--color-primary-50` through `--color-primary-950` using OKLCH values from Tailwind's default blue palette (these are the "professional blues" per DSGN-01)
         - `--color-surface-50` through `--color-surface-950` using OKLCH values from Tailwind's default slate palette (the "grays" per DSGN-01)
         - `--font-sans: "Inter Variable", ui-sans-serif, system-ui, sans-serif;`
         - `--font-display: "DM Sans Variable", ui-sans-serif, system-ui, sans-serif;`
       Use the exact OKLCH values from the RESEARCH.md file.

    5. Update the root `.gitignore` (at `/Users/patrykattc/work/jobs/.gitignore`) by appending:
       ```
       # Astro site
       node_modules/
       site/dist/
       site/.astro/
       ```

    Do NOT create a `tailwind.config.js` -- Tailwind v4 uses CSS-first configuration via `@theme`.
    Do NOT use `@astrojs/tailwind` -- it is deprecated for Tailwind v4. Use `@tailwindcss/vite` directly.
  </action>
  <verify>
    ```bash
    cd /Users/patrykattc/work/jobs/site
    cat astro.config.mjs | grep -q 'base.*jobs' && echo "base path OK"
    cat astro.config.mjs | grep -q 'trailingSlash.*always' && echo "trailingSlash OK"
    cat src/styles/global.css | grep -q '@theme' && echo "theme tokens OK"
    cat src/styles/global.css | grep -q 'primary-500' && echo "primary palette OK"
    cat src/styles/global.css | grep -q 'surface-500' && echo "surface palette OK"
    cat src/styles/global.css | grep -q 'font-display' && echo "font tokens OK"
    grep -q 'site/dist' /Users/patrykattc/work/jobs/.gitignore && echo "gitignore OK"
    grep -q 'site/.astro' /Users/patrykattc/work/jobs/.gitignore && echo "gitignore astro OK"
    grep -q 'node_modules' /Users/patrykattc/work/jobs/.gitignore && echo "gitignore node_modules OK"
    npm run build 2>&1 | tail -5
    ```
  </verify>
  <done>
    Astro project scaffolded in `/site` with `base: '/jobs'`, `trailingSlash: 'always'`, Tailwind v4 via `@tailwindcss/vite`, professional blues/grays `@theme` palette with OKLCH values, Inter + DM Sans font family tokens, and root `.gitignore` updated with `node_modules/`, `site/dist/`, `site/.astro/`.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create BaseLayout with SEO meta tags and minimal index page</name>
  <files>
    site/src/layouts/BaseLayout.astro
    site/src/pages/index.astro
    site/public/og-image.png
  </files>
  <action>
    1. Create a placeholder OG image at `site/public/og-image.png`:
       Use a simple 1200x630 placeholder. Generate it via a quick script or download a solid-color PNG. A simple approach:
       ```bash
       cd /Users/patrykattc/work/jobs/site/public
       python3 -c "
       # Create a minimal 1200x630 PNG with primary-600 blue background
       import struct, zlib
       w, h = 1200, 630
       # RGB for primary-600 blue (approx oklch 0.546 0.245 262.881 -> #4F46E5-ish)
       r, g, b = 59, 93, 216
       raw = b''
       for y in range(h):
           raw += b'\x00' + bytes([r, g, b]) * w
       deflated = zlib.compress(raw)
       def chunk(ctype, data):
           c = ctype + data
           return struct.pack('>I', len(data)) + c + struct.pack('>I', zlib.crc32(c) & 0xffffffff)
       with open('og-image.png', 'wb') as f:
           f.write(b'\x89PNG\r\n\x1a\n')
           f.write(chunk(b'IHDR', struct.pack('>IIBBBBB', w, h, 8, 2, 0, 0, 0)))
           f.write(chunk(b'IDAT', deflated))
           f.write(chunk(b'IEND', b''))
       print('Created og-image.png (1200x630)')
       "
       ```
       If the Python approach fails, create any valid 1200x630 PNG by another means.

    2. Create `site/src/layouts/BaseLayout.astro` with:
       - Frontmatter that imports `@fontsource-variable/inter`, `@fontsource-variable/dm-sans`, and `../styles/global.css`
       - Import `ClientRouter` from `astro:transitions` (NOT `ViewTransitions` -- renamed in Astro 5)
       - A `Props` interface accepting `title: string`, `description: string`, `image?: string`
       - Construct `canonicalURL` via `new URL(Astro.url.pathname, Astro.site)`
       - Construct `absoluteImageURL` via `new URL(image, Astro.site)` where `image` defaults to `"/jobs/og-image.png"`
       - Full HTML shell with:
         - `<meta charset="UTF-8">`, viewport meta, generator meta
         - `<title>{title}</title>` and `<meta name="description">`
         - `<link rel="canonical">` with canonicalURL
         - OpenGraph tags: `og:type=website`, `og:url`, `og:title`, `og:description`, `og:image` (all with absolute URLs) -- satisfies SEO-01
         - Twitter Card tags: `twitter:card=summary_large_image`, `twitter:url`, `twitter:title`, `twitter:description`, `twitter:image` -- satisfies SEO-02
         - `<ClientRouter />` component in head
       - `<body>` with Tailwind classes: `bg-surface-50 text-surface-900 font-sans antialiased`
       - A `<slot />` for page content

       Follow the exact pattern from RESEARCH.md Pattern 3: BaseLayout with SEO Props.

    3. Create `site/src/pages/index.astro` with:
       - Import `BaseLayout` from `../layouts/BaseLayout.astro`
       - Wrap content in `<BaseLayout>` with:
         - `title="JobFlow â€” Job Search Automation"`
         - `description="Self-hosted pipeline that scrapes job boards, scores matches against your profile, and automates applications. 18K LOC, 581 tests, 3 platforms."`
       - A minimal `<main>` with:
         - An `<h1>` using `font-display text-4xl font-bold text-primary-900` showing "JobFlow"
         - A `<p>` using `text-lg text-surface-600` with "From discovery to application in one tool."
         - A brief paragraph using `text-surface-500` describing the project
       This is just a placeholder -- Phase 21 will build the real content sections.

    4. Verify the dev server starts and the page loads:
       ```bash
       cd /Users/patrykattc/work/jobs/site
       timeout 15 npm run dev 2>&1 | head -20
       ```
       Then verify the build works:
       ```bash
       npm run build 2>&1 | tail -10
       ```
  </action>
  <verify>
    ```bash
    cd /Users/patrykattc/work/jobs/site
    # Verify BaseLayout has OG tags
    grep -q 'og:title' src/layouts/BaseLayout.astro && echo "OG title OK"
    grep -q 'og:image' src/layouts/BaseLayout.astro && echo "OG image OK"
    grep -q 'og:url' src/layouts/BaseLayout.astro && echo "OG url OK"
    grep -q 'og:description' src/layouts/BaseLayout.astro && echo "OG description OK"
    grep -q 'twitter:card' src/layouts/BaseLayout.astro && echo "Twitter card OK"
    grep -q 'summary_large_image' src/layouts/BaseLayout.astro && echo "Twitter card type OK"
    # Verify font imports
    grep -q '@fontsource-variable/inter' src/layouts/BaseLayout.astro && echo "Inter font OK"
    grep -q '@fontsource-variable/dm-sans' src/layouts/BaseLayout.astro && echo "DM Sans font OK"
    # Verify ClientRouter (not ViewTransitions)
    grep -q 'ClientRouter' src/layouts/BaseLayout.astro && echo "ClientRouter OK"
    # Verify index page uses BaseLayout
    grep -q 'BaseLayout' src/pages/index.astro && echo "Index uses BaseLayout OK"
    # Verify OG image exists
    test -f public/og-image.png && echo "OG image file OK"
    # Verify build succeeds
    npm run build 2>&1 | tail -3
    # Verify build output has correct base path
    grep -r 'og:image' dist/ | head -1
    grep -r 'og:url' dist/ | head -1
    ```
  </verify>
  <done>
    BaseLayout component renders complete HTML with Inter/DM Sans font imports, global CSS, ClientRouter, and full OpenGraph + Twitter Card meta tags using absolute URLs. Index page uses BaseLayout and renders with the professional blues/grays palette. `npm run build` succeeds and the built HTML contains correct absolute OG URLs.
  </done>
</task>

</tasks>

<verification>
All 8 Phase 20 requirements verified:

1. **SETUP-01**: `astro.config.mjs` has `base: '/jobs'` and `trailingSlash: 'always'` -- verified by grep and build output
2. **SETUP-02**: `global.css` has `@import "tailwindcss"` + `@theme` with `primary-*` blues and `surface-*` grays via OKLCH -- verified by grep and visual render
3. **SETUP-03**: Fontsource `@fontsource-variable/inter` and `@fontsource-variable/dm-sans` imported in BaseLayout frontmatter -- verified by grep
4. **SETUP-04**: Root `.gitignore` has `node_modules/`, `site/dist/`, `site/.astro/` -- verified by grep
5. **SETUP-05**: BaseLayout has HTML shell, meta tags, font loading, global CSS import, `<ClientRouter />` -- verified by grep for each element
6. **DSGN-01**: Professional blues (`primary-*`) and grays (`surface-*`) defined in `@theme` using OKLCH values distinct from orange/teal palette -- verified in global.css
7. **SEO-01**: OpenGraph tags (`og:type`, `og:url`, `og:title`, `og:description`, `og:image`) with absolute URLs via `new URL(path, Astro.site)` -- verified in build output HTML
8. **SEO-02**: Twitter Card tags (`twitter:card=summary_large_image`, `twitter:url`, `twitter:title`, `twitter:description`, `twitter:image`) -- verified by grep

**End-to-end check:**
```bash
cd /Users/patrykattc/work/jobs/site
npm run build && npm run preview &
sleep 3
curl -s http://localhost:4321/jobs/ | grep -o 'og:[a-z]*' | sort -u
curl -s http://localhost:4321/jobs/ | grep -o 'twitter:[a-z]*' | sort -u
kill %1
```
</verification>

<success_criteria>
1. `npm run dev` inside `/site` serves a page at `localhost:4321/jobs/` with the `/jobs/` base path visible in asset URLs
2. `npm run build && npm run preview` produces identical output with no broken paths
3. Page renders with Inter body text and DM Sans headings in professional blues/grays palette
4. Page source shows all 5 OpenGraph meta tags and 5 Twitter Card meta tags with absolute `https://patrykgolabek.github.io/jobs/` URLs
5. Root `.gitignore` includes all three entries: `node_modules/`, `site/dist/`, `site/.astro/`
</success_criteria>

<output>
After completion, create `.planning/phases/20-foundation-and-configuration/20-01-SUMMARY.md`
</output>
