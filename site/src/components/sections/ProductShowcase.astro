---
const tabs = [
  {
    id: "tracker",
    label: "Job Tracker",
    image: "/screenshots/dashboard-main.png",
    alt: "Job tracker table showing 465 jobs with scores and filters",
    url: "localhost:8000/dashboard",
    title: "Smart Job Table",
    description: "Filter by score, platform, status. Sort and search across all discovered jobs.",
    icon: "table",
  },
  {
    id: "analytics",
    label: "Analytics",
    image: "/screenshots/dashboard-analytics.png",
    alt: "Analytics dashboard with charts and platform effectiveness metrics",
    url: "localhost:8000/dashboard/analytics",
    title: "Pipeline Analytics",
    description: "Score distribution, platform breakdown, and application funnel metrics.",
    icon: "chart",
  },
  {
    id: "kanban",
    label: "Kanban",
    image: "/screenshots/dashboard-kanban.png",
    alt: "Kanban board for managing job application pipeline",
    url: "localhost:8000/dashboard/kanban",
    title: "Visual Pipeline",
    description: "Drag-and-drop board to track applications from discovery to offer.",
    icon: "columns",
  },
];
---

<section id="showcase" data-animate class="py-20 bg-surface-50">
  <div class="max-w-5xl mx-auto px-4">
    <!-- Heading -->
    <h2 class="font-display text-3xl font-bold text-surface-900 text-center">
      Your Command Center
    </h2>
    <p class="mt-3 text-surface-600 text-center max-w-2xl mx-auto">
      Real-time dashboard for managing your entire job search pipeline
    </p>

    <!-- Tab bar -->
    <div class="mt-10 flex justify-center gap-2">
      {tabs.map((tab, i) => (
        <button
          data-tab={tab.id}
          class:list={[
            "px-5 py-2.5 rounded-full text-sm font-semibold transition-all cursor-pointer",
            i === 0
              ? "bg-primary-600 text-white shadow-md"
              : "glass text-surface-600 hover:bg-primary-50 hover:text-primary-600",
          ]}
        >
          {tab.label}
        </button>
      ))}
    </div>

    <!-- Screenshot display with browser chrome -->
    <div class="mt-8 rounded-lg overflow-hidden shadow-2xl border border-surface-200 ring-1 ring-primary-200/20">
      <!-- Title bar -->
      <div class="flex items-center gap-2 px-4 py-3 bg-surface-100 border-b border-surface-200">
        <!-- Traffic light dots -->
        <span class="w-3 h-3 rounded-full bg-red-400"></span>
        <span class="w-3 h-3 rounded-full bg-yellow-400"></span>
        <span class="w-3 h-3 rounded-full bg-green-400"></span>
        <!-- URL bar -->
        {tabs.map((tab, i) => (
          <span
            data-url={tab.id}
            class:list={[
              "flex-1 text-center text-xs text-surface-400 font-mono",
              i !== 0 && "hidden",
            ]}
          >
            {tab.url}
          </span>
        ))}
      </div>

      <!-- Screenshot panels (stacked for crossfade) -->
      <div class="relative">
        {tabs.map((tab, i) => (
          <img
            data-panel={tab.id}
            src={tab.image}
            alt={tab.alt}
            loading="lazy"
            class:list={[
              "w-full transition-opacity duration-300",
              i === 0
                ? "relative opacity-100 pointer-events-auto"
                : "absolute inset-0 opacity-0 pointer-events-none",
            ]}
          />
        ))}
      </div>
    </div>

    <!-- Feature callouts (switch with tabs) -->
    <div class="mt-8">
      {tabs.map((tab, i) => (
        <div
          data-callout={tab.id}
          class:list={[
            "grid grid-cols-1 md:grid-cols-3 gap-6",
            i !== 0 && "hidden",
          ]}
        >
          <!-- Single callout card -->
          <div class="flex items-start gap-4 p-5 rounded-xl bg-white border border-surface-200">
            <div class="w-10 h-10 rounded-lg bg-primary-100 flex items-center justify-center text-primary-600 shrink-0">
              {tab.icon === "table" && (
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <rect x="3" y="3" width="18" height="18" rx="2" />
                  <line x1="3" y1="9" x2="21" y2="9" />
                  <line x1="3" y1="15" x2="21" y2="15" />
                  <line x1="9" y1="3" x2="9" y2="21" />
                  <line x1="15" y1="3" x2="15" y2="21" />
                </svg>
              )}
              {tab.icon === "chart" && (
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <line x1="18" y1="20" x2="18" y2="10" />
                  <line x1="12" y1="20" x2="12" y2="4" />
                  <line x1="6" y1="20" x2="6" y2="14" />
                </svg>
              )}
              {tab.icon === "columns" && (
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <rect x="3" y="3" width="5" height="18" rx="1" />
                  <rect x="10" y="3" width="5" height="14" rx="1" />
                  <rect x="17" y="3" width="5" height="10" rx="1" />
                </svg>
              )}
            </div>
            <div>
              <h3 class="font-display font-semibold text-surface-900">
                {tab.title}
              </h3>
              <p class="mt-1 text-sm text-surface-600 leading-relaxed">
                {tab.description}
              </p>
            </div>
          </div>

          <!-- Supporting callout cards per tab -->
          {tab.id === "tracker" && (
            <>
              <div class="flex items-start gap-4 p-5 rounded-xl bg-white border border-surface-200">
                <div class="w-10 h-10 rounded-lg bg-primary-100 flex items-center justify-center text-primary-600 shrink-0">
                  <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <circle cx="11" cy="11" r="8" />
                    <line x1="21" y1="21" x2="16.65" y2="16.65" />
                  </svg>
                </div>
                <div>
                  <h3 class="font-display font-semibold text-surface-900">
                    Instant Search
                  </h3>
                  <p class="mt-1 text-sm text-surface-600 leading-relaxed">
                    Full-text search across all job titles, companies, and descriptions with FTS5.
                  </p>
                </div>
              </div>
              <div class="flex items-start gap-4 p-5 rounded-xl bg-white border border-surface-200">
                <div class="w-10 h-10 rounded-lg bg-primary-100 flex items-center justify-center text-primary-600 shrink-0">
                  <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3" />
                  </svg>
                </div>
                <div>
                  <h3 class="font-display font-semibold text-surface-900">
                    Multi-Filter
                  </h3>
                  <p class="mt-1 text-sm text-surface-600 leading-relaxed">
                    Combine score, platform, status, and date filters to zero in on the best matches.
                  </p>
                </div>
              </div>
            </>
          )}

          {tab.id === "analytics" && (
            <>
              <div class="flex items-start gap-4 p-5 rounded-xl bg-white border border-surface-200">
                <div class="w-10 h-10 rounded-lg bg-primary-100 flex items-center justify-center text-primary-600 shrink-0">
                  <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M21.21 15.89A10 10 0 1 1 8 2.83" />
                    <path d="M22 12A10 10 0 0 0 12 2v10z" />
                  </svg>
                </div>
                <div>
                  <h3 class="font-display font-semibold text-surface-900">
                    Platform Breakdown
                  </h3>
                  <p class="mt-1 text-sm text-surface-600 leading-relaxed">
                    See which platforms yield the highest-scoring jobs and best response rates.
                  </p>
                </div>
              </div>
              <div class="flex items-start gap-4 p-5 rounded-xl bg-white border border-surface-200">
                <div class="w-10 h-10 rounded-lg bg-primary-100 flex items-center justify-center text-primary-600 shrink-0">
                  <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <polyline points="22 12 18 12 15 21 9 3 6 12 2 12" />
                  </svg>
                </div>
                <div>
                  <h3 class="font-display font-semibold text-surface-900">
                    Application Funnel
                  </h3>
                  <p class="mt-1 text-sm text-surface-600 leading-relaxed">
                    Track conversion rates from discovery through scoring to submitted applications.
                  </p>
                </div>
              </div>
            </>
          )}

          {tab.id === "kanban" && (
            <>
              <div class="flex items-start gap-4 p-5 rounded-xl bg-white border border-surface-200">
                <div class="w-10 h-10 rounded-lg bg-primary-100 flex items-center justify-center text-primary-600 shrink-0">
                  <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <polyline points="9 11 12 14 22 4" />
                    <path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11" />
                  </svg>
                </div>
                <div>
                  <h3 class="font-display font-semibold text-surface-900">
                    Status Tracking
                  </h3>
                  <p class="mt-1 text-sm text-surface-600 leading-relaxed">
                    Move jobs through stages: discovered, applied, interviewing, offer, rejected.
                  </p>
                </div>
              </div>
              <div class="flex items-start gap-4 p-5 rounded-xl bg-white border border-surface-200">
                <div class="w-10 h-10 rounded-lg bg-primary-100 flex items-center justify-center text-primary-600 shrink-0">
                  <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <rect x="1" y="4" width="22" height="16" rx="2" ry="2" />
                    <line x1="1" y1="10" x2="23" y2="10" />
                  </svg>
                </div>
                <div>
                  <h3 class="font-display font-semibold text-surface-900">
                    Quick Actions
                  </h3>
                  <p class="mt-1 text-sm text-surface-600 leading-relaxed">
                    One-click apply, dismiss, or archive directly from the board view.
                  </p>
                </div>
              </div>
            </>
          )}
        </div>
      ))}
    </div>
  </div>
</section>

<script>
function initShowcase() {
  const container = document.getElementById('showcase');
  if (!container) return;

  const buttons = container.querySelectorAll<HTMLButtonElement>('[data-tab]');
  const panels = container.querySelectorAll<HTMLImageElement>('[data-panel]');
  const callouts = container.querySelectorAll<HTMLElement>('[data-callout]');
  const urls = container.querySelectorAll<HTMLElement>('[data-url]');

  buttons.forEach(btn => {
    btn.addEventListener('click', () => {
      const tab = btn.dataset.tab;

      // Update buttons
      buttons.forEach(b => {
        const isActive = b.dataset.tab === tab;
        b.classList.toggle('bg-primary-600', isActive);
        b.classList.toggle('text-white', isActive);
        b.classList.toggle('shadow-md', isActive);
        // Remove glass styles from active button
        b.classList.toggle('glass', !isActive);
        b.classList.toggle('text-surface-600', !isActive);
        b.classList.toggle('hover:bg-primary-50', !isActive);
        b.classList.toggle('hover:text-primary-600', !isActive);
      });

      // Crossfade panels
      panels.forEach(p => {
        const isActive = p.dataset.panel === tab;
        if (isActive) {
          // Make active panel the relative one (takes up space)
          p.classList.add('relative', 'opacity-100', 'pointer-events-auto');
          p.classList.remove('absolute', 'inset-0', 'opacity-0', 'pointer-events-none');
        } else {
          p.classList.add('absolute', 'inset-0', 'opacity-0', 'pointer-events-none');
          p.classList.remove('relative', 'opacity-100', 'pointer-events-auto');
        }
      });

      // Switch URL bar text
      urls.forEach(u => {
        u.classList.toggle('hidden', u.dataset.url !== tab);
      });

      // Switch callouts
      callouts.forEach(c => {
        c.classList.toggle('hidden', c.dataset.callout !== tab);
      });
    });
  });
}

initShowcase();
document.addEventListener('astro:page-load', initShowcase);
</script>
